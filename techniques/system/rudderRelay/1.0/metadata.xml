<TECHNIQUE name="Rudder relay">
  <DESCRIPTION>Configure the relay components</DESCRIPTION>
  <SYSTEM>true</SYSTEM>

  <FILES>
    <FILE name="common/reload_rudder_services.cf">
      <INCLUDED>true</INCLUDED>
    </FILE>
    <FILE name="apache/main.cf">
      <INCLUDED>true</INCLUDED>
    </FILE>
    <FILE name="apache/system_rudder_apache_networks_configuration.cf">
      <INCLUDED>true</INCLUDED>
    </FILE>
    <FILE name="apache/system_rudder_apache_webdav_configuration.cf">
      <INCLUDED>true</INCLUDED>
    </FILE>
    <FILE name="relayd/relayd.cf">
      <INCLUDED>true</INCLUDED>
    </FILE>
    <FILE name="relayd/relayd.conf.tpl">
      <OUTPATH>rudderRelay/1.0/relayd/relayd.conf.tpl</OUTPATH>
      <INCLUDED>false</INCLUDED>
    </FILE>
  </FILES>

  <BUNDLES>
    <NAME>system_rudder_apache_configuration</NAME>
    <NAME>system_rudder_relay_configuration</NAME>
  </BUNDLES>

  <SYSTEMVARS>
    <NAME>RUDDER_SERVER_ROLES</NAME>
  </SYSTEMVARS>

  <SECTIONS>
    <SECTION name="Apache service" component="true" multivalued="true">
      <REPORTKEYS>
        <VALUE>Enabled</VALUE>
        <VALUE>Started</VALUE>
      </REPORTKEYS>
    </SECTION>
    <SECTION name="Apache configuration" component="true" multivalued="true">
      <REPORTKEYS>
        <VALUE>Allowed networks permissions</VALUE>
        <VALUE>Allowed networks configuration</VALUE>
        <VALUE>Remote run permissions</VALUE>
        <VALUE>Remote run configuration</VALUE>
        <VALUE>Webdav configuration</VALUE>
        <VALUE>Webdav permissions</VALUE>
      </REPORTKEYS>
    </SECTION>
    <SECTION name="Rudder-relayd service" component="true" multivalued="true">
      <REPORTKEYS>
        <VALUE>Configuration permissions</VALUE>
        <VALUE>Configuration</VALUE>
        <VALUE>Enabled</VALUE>
        <VALUE>Started</VALUE>
      </REPORTKEYS>
    </SECTION>
  </SECTIONS>
</TECHNIQUE>
