## ###########################################################
## This file is protected by your Rudder infrastructure. ###
## Manually editing the file might lead your Rudder ###
## infrastructure to change back the server's ###
## configuration and/or to raise a compliance alert. ###
## ##########################################################

##Â This is the configuration file for NXLog, used to forward all the messages
## generated by the Rudder agent to the policy server

## Please set the ROOT to the folder your nxlog was installed into,
## otherwise it will not start.
#define ROOT C:\Program Files\nxlog
define ROOT ${install_path}\nxlog

Moduledir %ROOT%\modules
CacheDir %ROOT%\data
Pidfile %ROOT%\data\nxlog.pid
SpoolDir %ROOT%\data
LogFile %ROOT%\data\nxlog.log

<Extension charconv>
    Module      xm_charconv
    AutodetectCharsets utf-8, euc-jp, utf-16, utf-32, iso8859-2
</Extension>

<Extension syslog>
    Module	xm_syslog
</Extension>

<Input in>
    Module      im_msvistalog
# For windows 2003 and earlier use the following:
#   Module      im_mseventlog

# We only forward relevant messages from the rudder agent
    Exec if not ($EventID == 100 or $EventID == 101 or $EventID == 102 or $EventID == 103 or $EventID == 104 or $EventID == 105 or $EventID == 106 or $EventID == 107 or $EventID == 108) drop();
</Input>

<Output out>
    Module      ${transport_module}
    Host        ${server}
    Port        ${port}
    Exec	convert_fields("AUTO", "utf-8");

    Exec	to_syslog_bsd();
</Output>

<Route 1>
    Path        in => out
</Route>


